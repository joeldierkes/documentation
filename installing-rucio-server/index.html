<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.74">
<link rel="alternate" type="application/rss+xml" href="/documentation/blog/rss.xml" title="Rucio Documentation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/documentation/blog/atom.xml" title="Rucio Documentation Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Rucio Documentation" href="/documentation/opensearch.xml">
<link rel="stylesheet" href="/documentation/css/custom.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,700&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:400,500,700&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap">
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">Installing Rucio Server | Rucio Documentation</title><meta data-react-helmet="true" property="og:url" content="https://rucio.github.io/documentation/installing-rucio-server"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Installing Rucio Server | Rucio Documentation"><meta data-react-helmet="true" name="description" content="Prerequisites"><meta data-react-helmet="true" property="og:description" content="Prerequisites"><link data-react-helmet="true" rel="shortcut icon" href="/documentation/img/android-chrome-512x512.png"><link data-react-helmet="true" rel="canonical" href="https://rucio.github.io/documentation/installing-rucio-server"><link data-react-helmet="true" rel="alternate" href="https://rucio.github.io/documentation/installing-rucio-server" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://rucio.github.io/documentation/installing-rucio-server" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/documentation/assets/css/styles.ea1ffc63.css">
<link rel="preload" href="/documentation/assets/js/styles.77361610.js" as="script">
<link rel="preload" href="/documentation/assets/js/runtime~main.e1a555d6.js" as="script">
<link rel="preload" href="/documentation/assets/js/main.ab512f86.js" as="script">
<link rel="preload" href="/documentation/assets/js/1.23f9a037.js" as="script">
<link rel="preload" href="/documentation/assets/js/2.6fba58f5.js" as="script">
<link rel="preload" href="/documentation/assets/js/304.b2533c63.js" as="script">
<link rel="preload" href="/documentation/assets/js/307.083e8fc7.js" as="script">
<link rel="preload" href="/documentation/assets/js/935f2afb.4660e9c4.js" as="script">
<link rel="preload" href="/documentation/assets/js/17896441.431fcf33.js" as="script">
<link rel="preload" href="/documentation/assets/js/93a66401.a819b8d6.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/documentation/"><img src="/documentation/img/rucio_horizontaled_black.svg" alt="Rucio Documentation" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/documentation/img/rucio_horizontaled_white.svg" alt="Rucio Documentation" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Rucio Documentation</strong></a><a class="navbar__item navbar__link" href="/documentation/rucio_client_api">Client API</a><a class="navbar__item navbar__link" href="/documentation/rucio_rest_api">REST API</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/documentation/"><img src="/documentation/img/rucio_horizontaled_black.svg" alt="Rucio Documentation" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/documentation/img/rucio_horizontaled_white.svg" alt="Rucio Documentation" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Rucio Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/documentation/rucio_client_api">Client API</a></li><li class="menu__list-item"><a class="menu__link" href="/documentation/rucio_rest_api">REST API</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><div class="docSidebarContainer_0YBq" role="complementary"><div class="sidebar_a3j0"><div class="menu menu--responsive thin-scrollbar menu_cyFh"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/">Welcome!</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/Before-you-get-started">Before You Get Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/What-is-rucio">What is Rucio?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/Main-components-of-rucio">Main Components of Rucio</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/Additional-layers-and-Resources">Additional Layers and Resources</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/requirements">Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/concepts">Concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/releasepolicy">Release Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/release-notes">Release Notes</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Try Rucio</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/Try-rucio">Try Rucio!</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/setting-up-demo">Setting up a Rucio demo environment</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Using Rucio</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/setting-up-rucio-client">Setting Up the Rucio Client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/using-rucio-client">Using the Rucio Client</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Rucio Operator Documentation</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/documentation/installing-rucio-server">Installing Rucio Server</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/installing-rucio-daemons">Installing Rucio Daemons</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/monitoring">Monitoring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/database">Database Operations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/configuration-parameters">Configuration parameters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/configure-rucio-globus">Configure Rucio To Use Globus Online as a Transfer Tool</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Rucio Developer Documentation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/contributing">Contributing Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/component_leads">Component leads</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Miscellaneous</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/policy-packages">Policy packages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/notifications">Notifications</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/metadata-attributes">Metadata Attributes</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Contribution</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/Contributing">Contributing Guide for Documentation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/page-types">Types of Pages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/contributing-improvements">Contributing Improvements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/new-content-contribution-guide">New Content Contribution Guide</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About Us</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/about-our-contributors">About Our Contributors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/how-to-reach-us">Contact us</a></li></ul></li></ul></div></div></div><main class="docMainContainer_r8cw"><div class="container padding-vert--lg docItemWrapper_NJLN"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><header><h1 class="docTitle_-X99">Installing Rucio Server</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="prerequisites"></a>Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h2><p>The Rucio server runs on Python 2.7, 3.6 and 3.7 on any Unix-like platform.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="install-via-pip"></a>Install via pip<a class="hash-link" href="#install-via-pip" title="Direct link to heading">#</a></h2><p>Heads up: We recommend to use the docker-based install (see next section) as it
will configure many things for you automatically. Only use the pip-based install
if you have a good reason and know how to configure your webservices manually:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> rucio</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>This will pull the latest release from
<a href="https://pypi.python.org/pypi/rucio/" target="_blank" rel="noopener noreferrer"><strong>PyPi</strong></a>. The Rucio server also needs
several Python dependencies. These are all listed in the file
<a href="https://github.com/rucio/rucio/blob/master/etc/pip-requires" target="_blank" rel="noopener noreferrer"><code>etc/pip-requires</code></a>
and will be pulled in as necessary.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="install-via-docker"></a>Install via Docker<a class="hash-link" href="#install-via-docker" title="Direct link to heading">#</a></h2><p>A simple server without SSL can be started like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">rucio-server -p </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain">:80 -d rucio/rucio-server</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>This will start up a simple server using sqlite based on an automatically
generated configuration. You can check if the server is running with</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> http://localhost/ping</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>This should return the Rucio version used in the container. Any other curl
requests will not work as the database backend is not initialized as this image
is meant to be used with an already bootstrapped database backend. I.e., that
the container has to be configured to point to the correct database. There are
two ways to manage the Rucio configuration: using environment variables or by
mounting a full rucio.cfg.</p><p>If you want to set the connection string for the database it can be done using
the <code>RUCIO_CFG_DATABASE_DEFAULT</code> environment variable, e.g., to start a
container connecting to a MySQL DB running at <code>mysql.db</code> you could use something
like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">rucio-server </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">RUCIO_CFG_DATABASE_DEFAULT</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;mysql+pymysql://rucio:rucio@mysql.db/rucio&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain">:80 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -d </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rucio/rucio-server</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The are much more configuration parameters available that will be listed at the
end of this readme.</p><p>Another way to configure Rucio is to directly mount a complete rucio.cfg into
the container. This will then be used instead of the auto-generated one, e.g.,
if you have a rucio.cfg ready on your host system under <code>/tmp/rucio.cfg</code> you
could start a container like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">rucio-server </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /tmp/rucio.cfg:/opt/rucio/etc/rucio.cfg </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain">:80 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -d </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rucio/rucio-server</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The rucio.cfg is used to configure the database backend.</p><p>If you want to enable SSL you would need to set the <code>RUCIO_ENABLE_SSL</code> variable
and also need to include the host certificate, key and the the CA certificate as
volumes. E.g.,:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">rucio-server </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /tmp/ca.pem:/etc/grid-security/ca.pem </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /tmp/hostcert.pem:/etc/grid-security/hostcert.pem </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /tmp/hostkey.pem:/etc/grid-security/hostkey.pem </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /tmp/rucio.cfg:/opt/rucio/etc/rucio.cfg </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">443</span><span class="token plain">:443 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">RUCIO_ENABLE_SSL</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">True </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -d </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rucio/rucio-server</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>By default the output of the Apache web server is written directly to stdout and
stderr. If you would rather direct them into separate files it can be done using
the <code>RUCIO_ENABLE_LOGS</code> variable. The storage folder of the logs can be used as
a volume:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">rucio-server </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /tmp/rucio.cfg:/opt/rucio/etc/rucio.cfg </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /tmp/logs:/var/log/httpd </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain">:80 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">RUCIO_ENABLE_LOGS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">True </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -d </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rucio/rucio-server</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="environment-variables"></a>Environment Variables<a class="hash-link" href="#environment-variables" title="Direct link to heading">#</a></h2><p>As shown in the examples above the rucio-server image can be configured using
environment variables that are passed with <code>docker run</code>. Below is a list of all
available variables and their behaviour:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="rucio_enable_ssl"></a>RUCIO_ENABLE_SSL<a class="hash-link" href="#rucio_enable_ssl" title="Direct link to heading">#</a></h3><p>By default, the rucio server runs without SSL on port 80. If you want to enable
SSL set this variable to <code>True</code>. If you enable SSL you will also have to provide
the host certificate and key and the certificate authority file. The server will
look for <code>hostcert.pem</code>, <code>hostkey.pem</code> and <code>ca.pem</code> under <code>/etc/grid-security</code>
so you will have to mount them as volumes. Furthermore you will also have to
expose port 443.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="rucio_ca_path"></a>RUCIO_CA_PATH<a class="hash-link" href="#rucio_ca_path" title="Direct link to heading">#</a></h3><p>If you are using SSL and want use <code>SSLCACertificatePath</code> and
<code>SSLCARevocationPath</code> you can do so by specifying the path in this variable.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="rucio_define_aliases"></a>RUCIO_DEFINE_ALIASES<a class="hash-link" href="#rucio_define_aliases" title="Direct link to heading">#</a></h3><p>By default, the web server is configured with all common rest endpoints except
the authentication endpoint. If you want to specify your own set of aliases you
can set this variable to <code>True</code>. The web server then expects an alias file under
<code>/opt/rucio/etc/aliases.conf</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="rucio_enable_logs"></a>RUCIO_ENABLE_LOGS<a class="hash-link" href="#rucio_enable_logs" title="Direct link to heading">#</a></h3><p>By default, the log output of the web server is written to stdout and stderr. If
you set this variable to <code>True</code> the output will be written to <code>access_log</code> and
<code>error_log</code> under <code>/var/log/httpd</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="rucio_log_level"></a>RUCIO_LOG_LEVEL<a class="hash-link" href="#rucio_log_level" title="Direct link to heading">#</a></h3><p>The default log level is [info]{.title-ref}. You can change it using this
variable.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="rucio_log_format"></a>RUCIO_LOG_FORMAT<a class="hash-link" href="#rucio_log_format" title="Direct link to heading">#</a></h3><p>The default rucio log format is
<code>%ht%tt%{X-Rucio-Forwarded-For}it%Tt%Dt\&quot;%{X-Rucio-Auth-Token}i\&quot;t%{X-Rucio-RequestId}it%{X-Rucio-Client-Ref}it\&quot;%r\&quot;t%\&gt;st%b</code>
You can set your own format using this variable.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="rucio_hostname"></a>RUCIO_HOSTNAME<a class="hash-link" href="#rucio_hostname" title="Direct link to heading">#</a></h3><p>This variable sets the server name in the apache config.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="rucio_server_admin"></a>RUCIO_SERVER_ADMIN<a class="hash-link" href="#rucio_server_admin" title="Direct link to heading">#</a></h3><p>This variable sets the server admin in the apache config.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="rucio_cfg-configuration-parameters"></a>RUCIO_CFG configuration parameters<a class="hash-link" href="#rucio_cfg-configuration-parameters" title="Direct link to heading">#</a></h2><p>Environment variables can be used to set values for the auto-generated
rucio.cfg. The names are derived from the actual names in the configuration file
prefixed by <code>RUCIO_CFG</code>, e.g., the <code>default</code> value in the <code>database</code> section
becomes <code>RUCIO_CFG_DATABASE_DEFAULT</code>. All available environment variables are:</p><ul><li>RUCIO_CFG_COMMON_LOGDIR</li><li>RUCIO_CFG_COMMON_LOGLEVEL</li><li>RUCIO_CFG_COMMON_MAILTEMPLATEDIR</li><li>RUCIO_CFG_DATABASE_DEFAULT</li><li>RUCIO_CFG_DATABASE_SCHEMA</li><li>RUCIO_CFG_DATABASE_POOL_RESET_ON_RETURN</li><li>RUCIO_CFG_DATABASE_ECHO</li><li>RUCIO_CFG_DATABASE_POLL_RECYCLE</li><li>RUCIO_CFG_DATABASE_POOL_SIZE</li><li>RUCIO_CFG_DATABASE_POOL_TIMEOUT</li><li>RUCIO_CFG_DATABASE_MAX_OVERFLOW</li><li>RUCIO_CFG_DATABASE_POWUSERACCOUNT</li><li>RUCIO_CFG_DATABASE_USERPASSWORD</li><li>RUCIO_CFG_MONITOR_CARBON_SERVER</li><li>RUCIO_CFG_MONITOR_CARBON_PORT</li><li>RUCIO_CFG_MONITOR_USER_SCOPE</li><li>RUCIO_CFG_TRACE_TRACEDIR</li><li>RUCIO_CFG_TRACE_BROKERS</li><li>RUCIO_CFG_TRACE_PORT</li><li>RUCIO_CFG_TRACE_USERNAME</li><li>RUCIO_CFG_TRACE_PASSWORD</li><li>RUCIO_CFG_TRACE_TOPIC</li><li>RUCIO_CFG_PERMISSION_POLICY</li><li>RUCIO_CFG_PERMISSION_SCHEMA</li><li>RUCIO_CFG_PERMISSION_LFN2PFN_ALGORITHM_DEFAULT</li><li>RUCIO_CFG_PERMISSION_SUPPORT</li><li>RUCIO_CFG_PERMISSION_SUPPORT_RUCIO</li><li>RUCIO_CFG_WEBUI_USERCERT</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="server-configuration-for-open-id-connect-authnz"></a>Server Configuration for Open ID Connect AuthN/Z<a class="hash-link" href="#server-configuration-for-open-id-connect-authnz" title="Direct link to heading">#</a></h2><p>In order to be able to use JSON web tokens (JWTs) and related OAuth2.0
authentication and authorization with Rucio, one first needs to have an account
with the Identity Provider (IdP) which will act as Rucio Admin account
representing the Rucio Application. Currently supported IdPs use Identity Access
Management (IAM) system. Once, you have got your Rucio Admin IAM account (and
its subclaim identifier), you will need to <a href="https://indigo-iam.github.io/docs/v/current/user-guide/client-registration.html" target="_blank" rel="noopener noreferrer"><strong>register two IAM Rucio
clients</strong></a>
linked to this account. Once it is done, please save the relevant client_id,
client_secret, and registration access token (RAT) some place safe, you will be
needing them. In both clients, one needs to setup the redirect_uris to include
both <a href="https://%5C%3Cyour_server_name%5C" target="_blank" rel="noopener noreferrer">https://\&lt;your_server_name\</a>/auth/oidc_token&gt; and
<a href="https://%5C%3Cyour_server_name%5C" target="_blank" rel="noopener noreferrer">https://\&lt;your_server_name\</a>/auth/oidc_code&gt; paths. We will use one client as
Rucio Auth IAM client (i.e. client for the authentication and authorization on
the Rucio server). This client needs to have <strong>token exchange</strong>, <strong>token
refresh</strong>, and <strong>authorization code grant</strong> enabled. For the former two you
might need to contact the IAM admin as such settings are usually not accessible
to IAM users. In addition, you will need to request your IAM admin to allow your
client returning refresh tokens with lifetime being visible in their unverified
header. In addition Rucio assumes refresh tokens to expire immediatelly after
their first use, which has to be also confirmed by your IAM admin. Second
client, let\&#x27;s call it Rucio Admin IAM client, will be used by a Rucio probe
script <strong>check_voms</strong> in order to synchronize existing Rucio accounts with Rucio
identities. Rucio will also use this client\&#x27;s credentials in order to request
token for itself. The IAM administrator must include the <strong>scim:read</strong> scope and
allow <strong>client credentials</strong> grant type for the Rucio Admin IAM client in order
to grant you rights to pre-provision IAM users for Rucio. Examples of the
configuration of these two clients follow below:</p><p>Example of the Rucio Auth IAM client configuration:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI json"><div tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;client_id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;AbcCDe123...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;registration_access_token&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;AbcCDe123...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;redirect_uris&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://rucio-auth.cern.ch/auth/oidc_token&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://rucio-auth.cern.ch/auth/oidc_code&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;client_name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;rucio-admin-client&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;client_uri&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;logo_uri&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;contacts&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;jaroslav.guenther@gmail.com&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;tos_uri&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;token_endpoint_auth_method&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client_secret_basic&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;scope&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> &quot;address fts phone openid profile offline_access \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rucio email wlcg wlcg.groups fts</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain">submit-transfer&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;grant_types&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;refresh_token&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;urn:ietf:params:oauth:grant-type:token-exchange&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;authorization_code&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;response_types&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;code&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;policy_uri&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;jwks_uri&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;jwks&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;jwksType&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;URI&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;application_type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;sector_identifier_uri&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;subject_type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;request_object_signing_alg&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;userinfo_signed_response_alg&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;userinfo_encrypted_response_alg&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;userinfo_encrypted_response_enc&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;id_token_signed_response_alg&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;id_token_encrypted_response_alg&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;id_token_encrypted_response_enc&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;default_max_age&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">60000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;require_auth_time&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;default_acr_values&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;initiate_login_uri&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;post_logout_redirect_uris&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;claims_redirect_uris&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;request_uris&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;software_statement&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;software_id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;software_version&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;code_challenge_method&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;registration_client_uri&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://wlcg.cloud.cnaf.infn.it/register/fdc297fc-0907-4a68-9022-3ccc7dd2501a&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;client_secret_expires_at&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;client_id_issued_at&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1574700620</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Example of the Rucio Admin IAM client configuration:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client_id&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;AbcDe123...&quot;</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;registration_access_token&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;AbcDe123...&quot;</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client_secret&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;AbcDe123...&quot;</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;redirect_uris&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client_name&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client_uri&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;logo_uri&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;contacts&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;jaroslav.guenther@gmail.com&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;tos_uri&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;token_endpoint_auth_method&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client_secret_basic&quot;</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;scope&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;address scim:read phone email wlcg profile \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    fts:submit-transfer rucio fts fts:submit-transfer&quot;</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;grant_types&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client_credentials&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;response_types&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;policy_uri&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;jwks_uri&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;jwks&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;jwksType&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;URI&quot;</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;application_type&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sector_identifier_uri&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;subject_type&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;request_object_signing_alg&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;userinfo_signed_response_alg&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;userinfo_encrypted_response_alg&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;userinfo_encrypted_response_enc&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;id_token_signed_response_alg&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;id_token_encrypted_response_alg&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;id_token_encrypted_response_enc&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;default_max_age&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">60000</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;require_auth_time&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;default_acr_values&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;initiate_login_uri&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;post_logout_redirect_uris&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;claims_redirect_uris&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;request_uris&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;software_statement&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;software_id&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;software_version&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;code_challenge_method&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> null,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;registration_client_uri&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://wlcg.cloud.cnaf.infn.it/register/5b5e5d37-926b-4b42-8a98-a0b4b28baf18&quot;</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client_secret_expires_at&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client_id_issued_at&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1574700703</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>To make the Rucio server aware of the two clients above, one has to exchange the
empty dictionary in <strong>etc/idpsecrets.json</strong> file with one containing the
relevant information. Example of such dictionary (for multiple IdPs) follows:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI json"><div tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;&lt;IdP nickname&gt;&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;redirect_uris&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://&lt;server_name&gt;/auth/oidc_token&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://&lt;server_name&gt;/auth/oidc_code&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;registration_access_token&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&lt;RAT_string&gt;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;client_secret&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&lt;client_secret&gt;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;SCIM&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;client_secret&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&lt;client_secret&gt;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;grant_type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client_credentials&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;registration_access_token&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&lt;RAT_string&gt;&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;issuer&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://&lt;issuer_server_name&gt;/&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;wlcg&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;redirect_uris&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://rucio-auth.cern.ch/auth/oidc_token&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://rucio-auth.cern.ch/auth/oidc_code&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;registration_access_token&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;eyJraWQiOi ...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;client_id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;fdc297fc-09 ...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;client_secret&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;APFVcga_X ...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;SCIM&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;client_secret&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;IQqAcMOa ...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;grant_type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client_credentials&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;registration_access_token&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;eyJraW ...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;client_id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;5b5e5d3 ...&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;issuer&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://wlcg.cloud.cnaf.infn.it/&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;xdc&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> ... </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>After this is done, please make sure your <strong>rucio.cfg</strong> file contains the
following section:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI cfg"><div tabindex="0" class="prism-code language-cfg codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[oidc]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">idpsecrets = /path/to/your/idpsecrets.json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin_issuer = &lt;IdP_nickname&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">expected_audience = &#x27;&lt;rucio&gt;&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">expected_scope = &#x27;openid profile&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Parameters \&#x27;idpsecrets\&#x27; and \&#x27;admin_issuer\&#x27; have to be present.
\&lt;IdP_nickname&gt; stands for your preferred IdP (e.g. \&quot;wlcg\&quot;). The IdP
specified under admin_issuer will be contacted to get information about Rucio
Users (SCIM) and to request tokens for the Rucio \&#x27;root\&#x27; account.  The
expected_scope and expected_audence parameters are optional and if not filled,
the Rucio server will set them to \&#x27;openid profile\&#x27; and \&#x27;rucio\&#x27;
respectively. The expected scopes and audiences have to be configured
correspondinly on the side of your registered clienst at your IdP (usually you
can control accepted scopes and audiences for your clients via an IdP web
interface).</p><p>To finalise the process, one should assign the OIDC identities to the relevant
Rucio admin_account_name (e.g. \&#x27;root\&#x27;, \&#x27;ddmadmin\&#x27;). This identity ID is
composed of the IAM account sub claim and issuer url such as demonstrated below:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">rucio-admin identity </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> --account admin_account_name </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --type OIDC </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --id </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SUB=b3127dc7-2be3-417b-9647-6bf61238ad01, \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    ISS=https://wlcg.cloud.cnaf.infn.it/&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --email </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;wlcg-doma-rucio@cern.ch&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>A second identity has to be added to the same admin_account_name representing
the client_credentials flow of the Rucio application, i.e.  of the Rucio Admin
IAM client from above. This identity consists of the client_id of the Rucio
Admin IAM client and the issuer (the token obtained via the client credentials
flow using the Rucio Admin IAM client will contain in the SUB claim the
client_id instead of the IAM account SUB claim):</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">rucio-admin identity </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> --account admin_account_name </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --type OIDC </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --id </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SUB=5b5e5d37-926b-4b42-8a98-a0b4b28baf18, \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    ISS=https://wlcg.cloud.cnaf.infn.it/&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --email </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;wlcg-doma-rucio@cern.ch&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Note: In case you can not/will not run the Rucio check_scim probe script in
order to sync Rucio accounts with their IAM identities, you should assign the
appropriate OIDC identity manually (as in the example above) to each Rucio
account which is meant to use the OIDC authN/Z.</p><p>In case you wish to use OIDC by default in order to login to the Rucio WebUI,
one has to configure also another block in the <code>rucio.cfg</code> file: <code>[webui]
auth_type = oidc auth_issuer = &lt;IdP nickname from the idpsecrets.json file&gt;</code>
This is not a mandatory section, if not filled a user will get directed to a
page with login choices.</p><p>In order to ensure the correct lifetime management of the tokens and auth
sessions, one also has to run the rucio-oauth-daemon run on the server!</p><p>Rucio servers may run also conveyor daemon, which is responsible for submission
of the transfers created in connection with existing Rucio rule. In case both,
the source and destination RSEs have attribute {\&#x27;oidc_support\&#x27;: True}
assigned, the Rucio account which created such a rule will be used to request a
JWT token for OAuth2 authentication with FTS. The issuer of user\&#x27;s token will
be used to get a valid OIDC token with the requested audience and scope for FTS
transfer. This new token will have either the same identity of the user
(received after user\&#x27;s token exchange with IdP) or it will have the identity of
the Rucio Admin IAM client (client_id will be in the \&#x27;sub\&#x27; claim) (received
after client credentials token flow of the admin). If in any of the two formerly
mentioned cases, valid token is present in Rucio DB beforehand, it will be used
in the header of the transfer request to FTS and no new token demand will be
made to IdP. The OIDC authentication mechanism shall be configured by the
following parameters in the rucio.cfg file: <code>[conveyor]
allow_user_oidc_tokens = False request_oidc_scope = &#x27;fts:submit-transfer&#x27;
request_oidc_audience = &#x27;fts&#x27;</code> If \&#x27;allow_user_oidc_tokens\&#x27; is set to True
the system will attempt to exchange a valid OIDC token (if any) of the account
that owns the rule/transfer for a token that has the \&#x27;request_oidc_scope\&#x27; and
\&#x27;request_oidc_audience\&#x27;. If set to False, the system will use the IdP issuer
of the account that owns the transfer, will get a Rucio admin client token with
the \&#x27;request_oidc_scope\&#x27; and \&#x27;request_oidc_audience\&#x27; and authenticate
against FTS with the Rucio admin client credentials on behalf of the user. The
allowed scopes and audiences have to be again also configured correspondingly
for your clients at the IdP side (usually through IdP web interface).</p><p>Note aside: For some IdPs it may happen that the scope and audience claims are
not a part of the token payload. For this reason Rucio has a fall-back mechanism
to get this information using the IdPs introspection endpoint. To allow Rucio to
introspect tokens that were not issued by its clients, please talk to the IdP
admin who should enable this functionality for your clients.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/rucio/documentation/tree/main/docs/../docs/installing_server.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2022-02-03T10:00:37.000Z" class="lastUpdatedDate_nN9m">2/3/2022</time> by <strong>Martin Barisits</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/documentation/using-rucio-client"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Using the Rucio Client</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/documentation/installing-rucio-daemons"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Installing Rucio Daemons Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link">Prerequisites</a></li><li><a href="#install-via-pip" class="table-of-contents__link">Install via pip</a></li><li><a href="#install-via-docker" class="table-of-contents__link">Install via Docker</a></li><li><a href="#environment-variables" class="table-of-contents__link">Environment Variables</a><ul><li><a href="#rucio_enable_ssl" class="table-of-contents__link">RUCIO_ENABLE_SSL</a></li><li><a href="#rucio_ca_path" class="table-of-contents__link">RUCIO_CA_PATH</a></li><li><a href="#rucio_define_aliases" class="table-of-contents__link">RUCIO_DEFINE_ALIASES</a></li><li><a href="#rucio_enable_logs" class="table-of-contents__link">RUCIO_ENABLE_LOGS</a></li><li><a href="#rucio_log_level" class="table-of-contents__link">RUCIO_LOG_LEVEL</a></li><li><a href="#rucio_log_format" class="table-of-contents__link">RUCIO_LOG_FORMAT</a></li><li><a href="#rucio_hostname" class="table-of-contents__link">RUCIO_HOSTNAME</a></li><li><a href="#rucio_server_admin" class="table-of-contents__link">RUCIO_SERVER_ADMIN</a></li></ul></li><li><a href="#rucio_cfg-configuration-parameters" class="table-of-contents__link">RUCIO_CFG configuration parameters</a></li><li><a href="#server-configuration-for-open-id-connect-authnz" class="table-of-contents__link">Server Configuration for Open ID Connect AuthN/Z</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/documentation/img/rucio_horizontaled_black.svg" alt="" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/documentation/img/rucio_horizontaled_white.svg" alt="" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></div><div class="footer__copyright">Copyright Â© 2021 CERN</div></div></div></footer></div>
<script src="/documentation/assets/js/styles.77361610.js"></script>
<script src="/documentation/assets/js/runtime~main.e1a555d6.js"></script>
<script src="/documentation/assets/js/main.ab512f86.js"></script>
<script src="/documentation/assets/js/1.23f9a037.js"></script>
<script src="/documentation/assets/js/2.6fba58f5.js"></script>
<script src="/documentation/assets/js/304.b2533c63.js"></script>
<script src="/documentation/assets/js/307.083e8fc7.js"></script>
<script src="/documentation/assets/js/935f2afb.4660e9c4.js"></script>
<script src="/documentation/assets/js/17896441.431fcf33.js"></script>
<script src="/documentation/assets/js/93a66401.a819b8d6.js"></script>
</body>
</html>